<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Affirm8.Views.Feedback.Review"
             xmlns:local="clr-namespace:Affirm8"
             xmlns:controls="clr-namespace:Affirm8.Controls"
             x:DataType="local:ReviewViewModel" 
             Title="Write Review">

    <ContentPage.BindingContext>
        <local:ReviewViewModel/>
    </ContentPage.BindingContext>

    <ContentPage.Content>
        <ScrollView Padding="16">
            <StackLayout Spacing="20">
                
                <!-- Header -->
                <Label Text="Write a Review"
                      FontSize="24"
                      FontFamily="Roboto-Medium"
                      TextColor="{AppThemeBinding Light={DynamicResource PrimaryTextColorLight}, Dark={DynamicResource PrimaryTextColorDark}}"
                      HorizontalOptions="Center" />

                <!-- Product Info (if applicable) -->
                <Border BackgroundColor="{AppThemeBinding Light={DynamicResource CardBackgroundLight}, Dark={DynamicResource CardBackgroundDark}}"
                       Stroke="{AppThemeBinding Light={DynamicResource BorderColorLight}, Dark={DynamicResource BorderColorDark}}"
                       StrokeThickness="1"
                       Padding="16">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="8" />
                    </Border.StrokeShape>
                    
                    <Grid ColumnDefinitions="Auto,*">
                        <Image Grid.Column="0"
                              Source="{Binding ProductImage}"
                              WidthRequest="60"
                              HeightRequest="60"
                              Aspect="AspectFill" />
                        
                        <StackLayout Grid.Column="1" 
                                    Margin="12,0,0,0"
                                    VerticalOptions="Center"
                                    Spacing="4">
                            <Label Text="{Binding ProductName}"
                                  FontSize="16"
                                  FontFamily="Roboto-Medium"
                                  TextColor="{AppThemeBinding Light={DynamicResource PrimaryTextColorLight}, Dark={DynamicResource PrimaryTextColorDark}}" />
                            <Label Text="{Binding ProductDescription}"
                                  FontSize="12"
                                  FontFamily="Roboto-Regular"
                                  TextColor="{AppThemeBinding Light={DynamicResource SecondaryTextColorLight}, Dark={DynamicResource SecondaryTextColorDark}}"
                                  MaxLines="2" />
                        </StackLayout>
                    </Grid>
                </Border>

                <!-- Rating Section -->
                <StackLayout Spacing="8">
                    <Label Text="Overall Rating"
                          FontSize="16"
                          FontFamily="Roboto-Medium"
                          TextColor="{AppThemeBinding Light={DynamicResource PrimaryTextColorLight}, Dark={DynamicResource PrimaryTextColorDark}}" />
                    
                    <controls:RatingControl Value="{Binding Rating}"
                                           IsReadOnly="False"
                                           HorizontalOptions="Start"
                                           Margin="20" />
                </StackLayout>

                <!-- Review Form -->
                <StackLayout Spacing="16">
                    
                    <!-- Review Title -->
                    <StackLayout Spacing="8">
                        <Label Text="Review Title"
                              FontSize="14"
                              FontFamily="Roboto-Medium"
                              TextColor="{AppThemeBinding Light={DynamicResource PrimaryTextColorLight}, Dark={DynamicResource PrimaryTextColorDark}}" />
                        
                        <Border BackgroundColor="Transparent"
                               Stroke="{AppThemeBinding Light={DynamicResource BorderColorLight}, Dark={DynamicResource BorderColorDark}}"
                               StrokeThickness="1">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="5" />
                            </Border.StrokeShape>
                            <Entry Placeholder="Enter a title for your review"
                                  Text="{Binding ReviewTitle}"
                                  FontFamily="Roboto-Regular"
                                  Margin="10"
                                  BackgroundColor="Transparent" />
                        </Border>
                    </StackLayout>

                    <!-- Review Description -->
                    <StackLayout Spacing="8">
                        <Label Text="Review Description"
                              FontSize="14"
                              FontFamily="Roboto-Medium"
                              TextColor="{AppThemeBinding Light={DynamicResource PrimaryTextColorLight}, Dark={DynamicResource PrimaryTextColorDark}}" />
                        
                        <Border BackgroundColor="Transparent"
                               Stroke="{AppThemeBinding Light={DynamicResource BorderColorLight}, Dark={DynamicResource BorderColorDark}}"
                               StrokeThickness="1">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="5" />
                            </Border.StrokeShape>
                            <Editor Placeholder="Share your thoughts about this product..."
                                   Text="{Binding ReviewDescription}"
                                   FontFamily="Roboto-Regular"
                                   HeightRequest="120"
                                   Margin="10"
                                   BackgroundColor="Transparent" />
                        </Border>
                    </StackLayout>

                    <!-- Additional Fields -->
                    <StackLayout Spacing="8">
                        <Label Text="Your Name"
                              FontSize="14"
                              FontFamily="Roboto-Medium"
                              TextColor="{AppThemeBinding Light={DynamicResource PrimaryTextColorLight}, Dark={DynamicResource PrimaryTextColorDark}}" />
                        
                        <Border BackgroundColor="Transparent"
                               Stroke="{AppThemeBinding Light={DynamicResource BorderColorLight}, Dark={DynamicResource BorderColorDark}}"
                               StrokeThickness="1">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="5" />
                            </Border.StrokeShape>
                            <Entry Placeholder="Enter your name"
                                  Text="{Binding ReviewerName}"
                                  FontFamily="Roboto-Regular"
                                  Margin="10"
                                  BackgroundColor="Transparent" />
                        </Border>
                    </StackLayout>

                    <StackLayout Spacing="8">
                        <Label Text="Email (Optional)"
                              FontSize="14"
                              FontFamily="Roboto-Medium"
                              TextColor="{AppThemeBinding Light={DynamicResource PrimaryTextColorLight}, Dark={DynamicResource PrimaryTextColorDark}}" />
                        
                        <Border BackgroundColor="Transparent"
                               Stroke="{AppThemeBinding Light={DynamicResource BorderColorLight}, Dark={DynamicResource BorderColorDark}}"
                               StrokeThickness="1">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="5" />
                            </Border.StrokeShape>
                            <Entry Placeholder="Enter your email"
                                  Text="{Binding ReviewerEmail}"
                                  Keyboard="Email"
                                  FontFamily="Roboto-Regular"
                                  Margin="10"
                                  BackgroundColor="Transparent" />
                        </Border>
                    </StackLayout>
                </StackLayout>

                <!-- Submit Button -->
                <Button Text="Submit Review"
                       Command="{Binding SubmitCommand}"
                       BackgroundColor="{AppThemeBinding Light={DynamicResource PrimaryColorLight}, Dark={DynamicResource PrimaryColorDark}}"
                       TextColor="White"
                       FontFamily="Roboto-Medium"
                       CornerRadius="8"
                       HeightRequest="45"
                       Margin="0,20,0,0" />

                <!-- Cancel Button -->
                <Button Text="Cancel"
                       Command="{Binding CancelCommand}"
                       BackgroundColor="Transparent"
                       TextColor="{AppThemeBinding Light={DynamicResource SecondaryTextColorLight}, Dark={DynamicResource SecondaryTextColorDark}}"
                       FontFamily="Roboto-Regular"
                       CornerRadius="8"
                       HeightRequest="45" />

            </StackLayout>
        </ScrollView>
    </ContentPage.Content>
</ContentPage>